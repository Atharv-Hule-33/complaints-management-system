<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Hospital Complaint Management System - Registration</title>
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <link rel="stylesheet" href="pages/css/userReg.css"/>
</head>
<style>
    @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap");
    body {
        background-color: #f8f9fa;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }

    .registration-container {
        max-width: 550px;
        margin: 0 auto;
        padding: 30px;
        background-color: #ffffff;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        margin-top: 5vh;
        margin-bottom: 5vh;
    }

    .registration-header {
        text-align: center;
        margin-bottom: 30px;
    }

    .registration-header h1 {
        color: #2b5797;
        font-size: 24px;
        font-weight: 600;
    }

    .registration-header .logo {
        width: 80px;
        margin-bottom: 15px;
    }

    .registration-form label {
        font-weight: 500;
        color: #495057;
    }

    .register-btn {
        background-color: #2b5797;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 10px 0;
        font-weight: 500;
        letter-spacing: 0.5px;
        transition: all 0.3s;
        width: 100%;
    }

    .register-btn:hover {
        background-color: #1e3c6a;
    }

    .login-link {
        text-align: center;
        margin-top: 20px;
        color: #6c757d;
    }

    .login-btn {
        color: #2b5797;
        background-color: transparent;
        border: 1px solid #2b5797;
        padding: 8px 20px;
        transition: all 0.3s;
    }

    .login-btn:hover {
        background-color: #2b5797;
        color: white;
    }

    .divider {
        height: 1px;
        background-color: #e9ecef;
        margin: 25px 0 15px;
    }

    .form-control:focus {
        border-color: #2b5797;
        box-shadow: 0 0 0 0.25rem rgba(43, 87, 151, 0.25);
    }

    .form-text {
        font-size: 12px;
    }

    .error-message {
        color: #dc3545;
        font-size: 14px;
        margin-top: 5px;
        display: none;
    }

    .password-strength {
        height: 5px;
        margin-top: 10px;
        border-radius: 5px;
        background-color: #e9ecef;
    }

    .password-strength-bar {
        height: 100%;
        border-radius: 5px;
        width: 0%;
        transition: all 0.3s;
    }

    .strength-weak {
        background-color: #dc3545;
        width: 33%;
    }

    .strength-medium {
        background-color: #ffc107;
        width: 66%;
    }

    .strength-strong {
        background-color: #198754;
        width: 100%;
    }

    .strength-text {
        font-size: 12px;
        margin-top: 5px;
    }

</style>
<body>
<div class="container">
    <div class="row">
        <div class="col-12">
            <div class="registration-container">
                <div class="registration-header">
                    <h1>Hospital Complaint Management System</h1>
                    <p class="text-muted">Create your account to submit and track complaints</p>
                </div>

                <form class="registration-form" id="userForm">
                    <div class="mb-3">
                        <label for="name" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="name" placeholder="Enter your full name"/>
                        <div class="error-message" id="name-error">Please enter your full name</div>
                    </div>

                    <div class="mb-3">
                        <label for="email" class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="email" placeholder="name@example.com"/>
                        <div class="error-message" id="email-error">Please enter a valid email address</div>
                    </div>

                    <div class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" placeholder="Create a password"/>
                        <div class="error-message" id="password-error">Password must be at least 8 characters</div>
                    </div>

                    <div class="mb-3">
                        <label for="confirm-password" class="form-label">Confirm Password</label>
                        <input type="password" class="form-control" id="confirm-password"
                               placeholder="Re-enter your password"/>
                        <div class="error-message" id="confirm-password-error">Passwords do not match</div>
                    </div>

                    <div class="mb-3">
                        <label for="phone" class="form-label">Phone Number</label>
                        <input type="tel" class="form-control" id="phone" placeholder="Enter your phone number"/>
                        <div class="error-message" id="phone-error">Please enter a valid phone number</div>
                    </div>

                    <div class="mb-4">
                        <label for="userType" class="form-label">User Type</label>
                        <select class="form-select" id="userType" aria-label="User type selection">
                            <option value="" selected disabled>Select user type</option>
                            <option value="USER">USER</option>
                            <option value="ADMIN">ADMIN</option>
                        </select>
                        <div class="error-message" id="user-type-error">Please select a user type</div>
                    </div>

                    <button type="submit" class="btn register-btn">Register</button>
                </form>

                <div class="divider"></div>

                <div class="login-link">
                    <p>Already have an account?</p>
                    <button class="btn login-btn" onclick="window.location.href='login.html'">Login</button>
                </div>
            </div>

        </div>
    </div>

</div>

<!-- Bootstrap JS Bundle  -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script>
    (() => {
        const apiUrl = "http://localhost:8080/auth/register";

        const form = document.querySelector(".registration-form");
        const nameInput = document.getElementById("name");
        const emailInput = document.getElementById("email");
        const passwordInput = document.getElementById("password");
        const confirmPasswordInput = document.getElementById("confirm-password");
        const phoneInput = document.getElementById("phone");
        const userTypeInput = document.getElementById("userType");

        // Form validation
        document
            .querySelector(".registration-form")
            .addEventListener("submit", function (e) {
                e.preventDefault();

                const errorElements = document.querySelectorAll(".error-message");
                errorElements.forEach((element) => {
                    element.style.display = "none";
                });

                let isValid = true;

                if (nameInput.value.trim().length < 3) {
                    document.getElementById("name-error").style.display = "block";
                    isValid = false;
                }

                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPattern.test(emailInput.value)) {
                    document.getElementById("email-error").style.display = "block";
                    isValid = false;
                }

                if (passwordInput.value.length < 8) {
                    document.getElementById("password-error").style.display = "block";
                    isValid = false;
                }

                if (passwordInput.value !== confirmPasswordInput.value) {
                    document.getElementById("confirm-password-error").style.display = "block";
                    isValid = false;
                }

                const phonePattern = /^\d{10,15}$/;
                if (!phonePattern.test(phoneInput.value.replace(/\D/g, ""))) {
                    document.getElementById("phone-error").style.display = "block";
                    isValid = false;
                }

                if (userTypeInput.value === "") {
                    document.getElementById("user-type-error").style.display = "block";
                    isValid = false;
                }
                const user = {
                    userName: nameInput.value.trim(),
                    userEmail: emailInput.value.trim(),
                    userPassword: passwordInput.value.trim(),
                    userType: userTypeInput.value.trim(),
                    userPhone: phoneInput.value.trim()
                };

                console.log(user);

                if (isValid) {
                    fetch(`${apiUrl}`, {
                        method: "POST",
                        headers: {"Content-Type": "application/json"},
                        body: JSON.stringify(user),
                    })
                        .then(response => {
                            if(response.status === 201){
                                alert("User added successfully.");
                                window.location.href = "login.html";
                            }else if(response.status === 409){
                                alert("email already exist!!");
                            }
                        })
                        .catch(() => {
                            alert("Something went wrong");
                        });
                } else {
                    alert("Please, Enter all the details accurately. ");
                }
            });
    })();
</script>
</body>
</html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

